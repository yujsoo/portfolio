import { useEffect, useLayoutEffect, useRef, useState } from 'react'
import { Link } from 'react-router-dom'
import introVideo from '../assets/intro.mp4'
import gsap from 'gsap'
import { ScrollTrigger } from 'gsap/ScrollTrigger'
import { useInView } from 'react-intersection-observer'
import { useAnimation, motion } from 'framer-motion'
import { useLocation } from 'react-router-dom'
import { projectItems } from '../data/projectItems'
import { otherItems } from '../data/otherItems'

function Home() {
  const [hoveredId, setHoveredId] = useState<number | null>(null)

  const introVideoCon = useRef(null)

  const controls = useAnimation()
  const controls2 = useAnimation()
  const controls3 = useAnimation()

  const [ref, inView] = useInView({ threshold: 0.5 })
  const [ref2, inView2] = useInView({
    threshold: 0.5,
  })
  const [ref3, inView3] = useInView({
    threshold: 0.2,
  })

  const titleControls = useAnimation()
  const [titleRef, titleInView] = useInView({ threshold: 0.1 })

  const listControls = useAnimation()
  const [listRef, listInView] = useInView({ threshold: 0.1 })

  useEffect(() => {
    if (inView) {
      controls.start({ opacity: 1, y: 0 })
    } else {
      controls.start({ opacity: 0, y: 30 })
    }
  }, [inView, controls])

  useEffect(() => {
    if (inView2) {
      controls2.start({ opacity: 1, x: 0 })
    } else {
      controls2.start({ opacity: 0, x: -100 })
    }
  }, [inView2, controls2])

  useEffect(() => {
    if (inView3) {
      controls3.start({ opacity: 1, y: 0 })
    } else {
      controls3.start({ opacity: 0, y: 50 })
    }
  }, [inView3, controls3])

  useLayoutEffect(() => {
    gsap.registerPlugin(ScrollTrigger)

    const timeline = gsap.timeline({
      scrollTrigger: {
        trigger: document.documentElement,
        scrub: 0.4,
        start: 'top',
        end: '+=500px',
      },
    })

    timeline.fromTo(
      introVideoCon.current,
      { y: 100, clipPath: `inset(0 50%)` },
      {
        y: 0,
        clipPath: `inset(0% 0%)`,
      },
    )
  }, [])

  useEffect(() => {
    if (titleInView) {
      titleControls.start({ opacity: 1, x: 0 })
    } else {
      titleControls.start({ opacity: 0, x: -50 })
    }
  }, [titleInView, titleControls])

  useEffect(() => {
    if (listInView) {
      listControls.start({ opacity: 1, y: 0 })
    } else {
      listControls.start({ opacity: 0, y: 50 })
    }
  }, [listInView, listControls])

  const location = useLocation()

  useEffect(() => {
    if (location.hash) {
      const targetId = location.hash.replace('#', '')
      const target = document.getElementById(targetId)
      if (target) {
        target.scrollIntoView({ behavior: 'smooth' })
      }
    }
  }, [location])

  return (
    <div className="overflow-hidden">
      <section className="max-w-screen-xl mx-auto pt-96 px-6">
        <div className="overflow-hidden bg-white inline-block">
          <motion.p
            className="text-[40px] md:text-[50px] lg:text-[70px] xl:text-[90px] font-PPNeueMontreal font-bold leading-none"
            initial={{ opacity: 0, y: '60%' }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.5, ease: 'easeOut' }}>
            Hello,
            <br /> I‚Äôm Jisoo Yu ‚Äî üëã
            <br />a Frontend Developer.
          </motion.p>
        </div>
        <div ref={introVideoCon}>
          <video
            className="relative z-2 w-full m-auto"
            autoPlay
            loop
            muted
            playsInline>
            <source src={introVideo} type="video/mp4" />
            Î∏åÎùºÏö∞Ï†ÄÍ∞Ä ÎπÑÎîîÏò§Î•º ÏßÄÏõêÌïòÏßÄ ÏïäÏäµÎãàÎã§.
          </video>
        </div>
        <motion.div
          ref={ref}
          initial={{ opacity: 0, y: 30 }}
          animate={controls}
          transition={{ duration: 0.6, ease: 'easeOut' }}
          className="mt-20 xl:mt-48 text-center text-md xl:text-xl font-PPNeueMontreal">
          <p>
            PASSIONATE ABOUT BUILDING <br />
            INTUITIVE AND PERFORMANT WEB APPLICATIONS
          </p>
          <p className="mt-12">CODE. IMPROVE. REPEAT.</p>
        </motion.div>
      </section>
      <section
        id="experience"
        className="max-w-screen-xl mx-auto pt-32 xl:pt-48 px-6">
        <div className="overflow-hidden">
          <motion.h3
            className="mb-16 text-5xl md:text-7xl font-bold font-PPNeueMontreal"
            ref={ref2}
            initial={{ opacity: 0, x: 0 }}
            animate={controls2}
            transition={{ duration: 0.6, ease: 'easeOut' }}>
            Selected Projects.
          </motion.h3>
        </div>
        <motion.div
          ref={ref3}
          initial={{ opacity: 0, y: 50 }}
          animate={controls3}
          transition={{ duration: 0.6, ease: 'easeOut' }}>
          <div className="flex justify-between items-end">
            <p className="text-xl font-bold">(6)</p>
            <p className="text-xl">Experience.</p>
          </div>
          <ul className="border-t-2 border-black">
            {projectItems.map((item) => (
              <li
                key={item.id}
                className=" border-black border-b hover:bg-black hover:text-white transition-all transition-duration-300"
                onMouseEnter={() => setHoveredId(item.id)}
                onMouseLeave={() => setHoveredId(null)}>
                <Link to={item.link} className="flex p-6 relative">
                  <div className="w-1/2 md:w-[24%] text-left relative overflow-hidden">
                    <motion.span
                      className="block"
                      initial={{ y: 0, opacity: 1 }}
                      animate={{
                        y: hoveredId === item.id ? '-100%' : 0,
                        opacity: hoveredId === item.id ? 0 : 1,
                      }}
                      transition={{
                        duration: 0.3,
                        ease: 'easeInOut',
                      }}>
                      {item.title}
                    </motion.span>
                    <motion.span
                      className="absolute top-0 left-0"
                      initial={{ y: '100%', rotateX: -90, opacity: 0 }}
                      animate={{
                        y: hoveredId === item.id ? '0%' : '100%',
                        rotateX: hoveredId === item.id ? 0 : -90,
                        opacity: hoveredId === item.id ? 1 : 0,
                      }}
                      transition={{
                        duration: 0.5,
                        ease: 'easeInOut',
                      }}
                      aria-hidden="true">
                      {item.title}
                    </motion.span>
                  </div>
                  <p className="flex-auto text-right md:text-left font-poppins">
                    {item.date}
                  </p>
                </Link>
              </li>
            ))}
          </ul>
          <div id="others" className="flex justify-between pt-24 items-end">
            <p className="text-xl font-bold">(2)</p>
            <p className="text-xl">Others.</p>
          </div>
          <ul className="border-t-2 border-black">
            {otherItems.map((item) => (
              <li
                key={item.id}
                className="border-black border-b hover:bg-black hover:text-white transition-all transition-duration-300"
                onMouseEnter={() => setHoveredId(item.id)}
                onMouseLeave={() => setHoveredId(null)}>
                <Link to={item.link} className="flex p-6 relative">
                  <div className="w-1/2 md:w-[24%] text-left relative overflow-hidden">
                    <motion.span
                      className="block"
                      initial={{ y: 0, opacity: 1 }}
                      animate={{
                        y: hoveredId === item.id ? '-100%' : 0,
                        opacity: hoveredId === item.id ? 0 : 1,
                      }}
                      transition={{
                        duration: 0.3,
                        ease: 'easeInOut',
                      }}>
                      {item.title}
                    </motion.span>
                    <motion.span
                      className="absolute top-0 left-0"
                      initial={{ y: '100%', rotateX: -90, opacity: 0 }}
                      animate={{
                        y: hoveredId === item.id ? '0%' : '100%',
                        rotateX: hoveredId === item.id ? 0 : -90,
                        opacity: hoveredId === item.id ? 1 : 0,
                      }}
                      transition={{
                        duration: 0.5,
                        ease: 'easeInOut',
                      }}
                      aria-hidden="true">
                      {item.title}
                    </motion.span>
                  </div>
                  <p className="flex-auto text-right md:text-left font-poppins">
                    {item.date}
                  </p>
                </Link>
              </li>
            ))}
          </ul>
        </motion.div>
      </section>
      <section
        id="about"
        className="flex max-w-screen-xl mx-auto pt-36 xl:pt-48 px-6 flex-wrap">
        <motion.div
          className="w-full md:w-1/2"
          ref={titleRef}
          initial={{ opacity: 0, x: -50 }}
          animate={titleControls}
          transition={{ duration: 0.6, ease: 'easeOut' }}>
          <h3 className="text-5xl md:text-7xl font-bold font-PPNeueMontreal leading-none">
            About Me.
          </h3>
        </motion.div>
        <motion.div
          className="w-full md:w-1/2 break-keep leading-normal"
          ref={listRef}
          initial={{ opacity: 0, y: 50 }}
          animate={listControls}
          transition={{ duration: 0.6, ease: 'easeOut' }}>
          <ul>
            <li className="py-10">
              <p className="px-2 mb-4 inline-block bg-black text-white">
                Introduce.
              </p>
              <p>
                ÏïΩ 3ÎÖÑ 10Í∞úÏõîÍ∞Ñ ÏõπÏóêÏù¥Ï†ÑÏãú Ïä§ÌÉÄÌä∏ÏóÖÏóêÏÑú ÌçºÎ∏îÎ¶¨ÏÖîÎ°ú Í∑ºÎ¨¥ÌïòÎ©∞
                Îã§ÏñëÌïú Ïõπ¬∑Ïï± ÌîÑÎ°úÏ†ùÌä∏Î•º Í≤ΩÌóòÌñàÏäµÎãàÎã§.
                <br /> ÎßàÌÅ¨ÏóÖ Íµ¨Ï°∞ÏôÄ Ï†ëÍ∑ºÏÑ±ÏùÑ Í≥†Î†§Ìï¥ ÎîîÏûêÏù∏ ÏôÑÏÑ±ÎèÑÎ•º ÎÜíÏù¥Îäî
                ÎèôÏãúÏóê, Í∞úÎ∞úÏûêÍ∞Ä Ìö®Ïú®Ï†ÅÏúºÎ°ú ÌôúÏö©Ìï† Ïàò ÏûàÎäî Íµ¨Ï°∞Î•º
                Í≥†ÎØºÌï¥ÏôîÏäµÎãàÎã§.
                <br /> Ïô∏Ï£º Í∞úÎ∞úÏûêÏôÄÏùò ÌòëÏóÖÏùÑ ÌÜµÌï¥ ÎîîÏûêÏù∏Í≥º Í∞úÎ∞ú Í∞ÑÏùò Í∞ÑÍ∑πÏùÑ
                ÏûêÏó∞Ïä§ÎüΩÍ≤å Ï¢ÅÌòÄÏôîÍ≥†, ÎîîÏûêÏù¥ÎÑàÏùò ÏùòÎèÑÎ•º ÏµúÎåÄÌïú Íµ¨ÌòÑÌïòÍ∏∞ ÏúÑÌï¥
                Í∞úÎ∞úÏ†ÅÏù∏ ÏãúÎèÑÎèÑ Íæ∏Ï§ÄÌûà Ìï¥ÏôîÏäµÎãàÎã§.
                <br /> Ïù¥Îü¨Ìïú Í≤ΩÌóòÏùÑ Î∞îÌÉïÏúºÎ°ú, Îçî ÍπäÏùÄ Í∏∞Ïà†Í≥º ÏÇ¨Ïö©Ïûê Í≤ΩÌóòÏóê
                ÎèÑÏ†ÑÌïòÎ©∞ ÏÇ¨Ïö©ÏûêÏôÄ Îç∞Ïù¥ÌÑ∞, Î°úÏßÅÏùÑ ÏïÑÏö∞Î•¥Îäî ÌîÑÎ°†Ìä∏ÏóîÎìú Í∞úÎ∞úÏûêÎ°ú
                ÏÑ±Ïû•ÌïòÍ≥†Ïûê Ìï©ÎãàÎã§.
              </p>
            </li>
            <li className="py-10">
              <p className="px-2 mb-4 inline-block bg-black text-white">
                Career.
              </p>
              <p>
                <span className="block mb-2 text-sm text-[#888]">
                  2020.06 ~ 2024.03
                </span>
                Îû©Ïä§ÌäúÎîîÏò§(Wrap Studio) / ÌçºÎ∏îÎ¶¨Ïã±ÌåÄ ÌåÄÏû•
              </p>
            </li>
            <li className="py-10 ">
              <p className="px-2 mb-4 inline-block bg-black text-white">
                Education.
              </p>
              <p className="mb-6">
                <span className="block mb-1 text-sm text-[#888]">
                  2016.03 - 2018.02
                </span>
                Í≤ΩÏù∏Ïó¨ÏûêÎåÄÌïôÍµê / Ìò∏ÌÖîÍ¥ÄÍ¥ëÌïôÍ≥º Ï†ÑÍ≥µ
              </p>
              <p className="mb-6">
                <span className="block mb-1 text-sm text-[#888]">
                  2019.11 - 2020.04
                </span>
                Ïä§ÎßàÌä∏Í∏∞Í∏∞ UI/UX ÏõπÎîîÏûêÏù∏(ÏõπÌçºÎ∏îÎ¶¨ÏÖî) Í≥ºÏ†ï ÏàòÎ£å
              </p>
              <p>
                <span className="block mb-1 text-sm text-[#888]">
                  2024.08 - 2025.04
                </span>
                Íµ¨Î¶ÑÌÜ§ Îî•Îã§Ïù¥Î∏å ÌîÑÎ°†Ìä∏ÏóîÎìú Í∞úÎ∞úÏûê Í≥ºÏ†ï ÏàòÎ£å
              </p>
            </li>
            <li className="py-10">
              <p className="px-2 mb-4 inline-block bg-black text-white">
                Channel.
              </p>
              <p>
                <Link
                  to="https://github.com/yujsoo/"
                  className="hover:underline">
                  GitHub. https://github.com/yujsoo/
                </Link>
              </p>
            </li>
            <li className="py-10">
              <p className="px-2 mb-4 inline-block bg-black text-white">
                What I Love(‚ô•Ô∏é) to Do!
              </p>
              <p className="mb-6">
                <span className="block mb-1 text-[#888]">Ïö¥Îèô</span>
                ÏΩîÎìúÏôÄ Ïã∏Ïö∞Í∏∞ ÏúÑÌï¥ÏÑ† Ï≤¥Î†•Í≥º Î©òÌÉà Í¥ÄÎ¶¨ÎèÑ Ï§ëÏöîÌïòÏ£†!
                <br /> ÌïÑÎùºÌÖåÏä§Î•º ÌïòÎ©∞ ÏßëÏ§ëÎ†•Í≥º Ïú†Ïó∞Ìï®ÏùÑ Ï±ôÍ∏∞Í≥† ÏûàÏäµÎãàÎã§.
              </p>
              <p>
                <span className="block mb-1 text-[#888]">Ïó¨Ìñâ</span>
                ÏÉàÎ°úÏö¥ Í≥µÍ∞ÑÍ≥º ÎÇØÏÑ† Î∂ÑÏúÑÍ∏∞Î•º ÎßàÏ£ºÌïòÎäî Í±∏ Ï¢ãÏïÑÌï¥Ïöî.
                <br /> Ïó¨ÌñâÏùÑ ÌÜµÌï¥ ÏûêÍ∑πÍ≥º ÏïÑÏù¥ÎîîÏñ¥Î•º ÏñªÍ≥§ Ìï©ÎãàÎã§.
              </p>
            </li>
          </ul>
        </motion.div>
      </section>
    </div>
  )
}

export default Home
